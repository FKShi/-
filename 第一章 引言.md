# 不确定性量化导论
## 引言
本书旨在为高年级本科生及入门研究生对不确定性量化提供一个广泛的数学介绍。这本书针对的是拥有数学和统计学背景的读者，而不是工程类。需要的数学背景包括线性函数分析，测量/概率理论以及部分基本的优化理论。2-5章提供了这些材料的综述。
如果不考虑这些预备知识的教授，本书适合30-45学时的课程，取决于主题和深度的选择。
## 第一章
### 1.1 什么是不确定性量化
UQ集合了对‘真实世界’的概率理论和统计实践。
一个经典的UQ问题是针对一个或多个数学模型的正确形式或正确参数值的一些不确定性的过程。
经典的UQ问题包含证明，预测，模型和软件的验证和有效性，参数估计，数据同化和反问题。最广泛的一个定义：
> UQ研究所有误差和不确定性的起源，包含如下部分：系统和随机测量误差；未知（ignorance）；理论模型的限制；这些模型的数值求解的限制；计算，近似和数值法的准确性和可靠性的限制；人的误差。一个更精确的定义是UQ是一个科学推论可靠性的端到端 （end-to-end）的研究。（U.S. 能源部， 2009， p. 135）

特别需要认识到UQ研究的端到端本质：我们在意的是每个信息间的关系，而不是这些信息或假设的真实性。切记他们只是现实的近似。这个一直可能是‘无用输入，无用输出’的风险。UQ不能告诉你模型是对的或真实的，只能告诉你是否（在某个程度上）接受这个模型的证实，然后你必须（在某个程度上）根据逻辑接收特定结论的证实。在作者看来，这是对理性思考的一个合适解释，但是对于类似‘自然系统的数值模型的验证和证实是不可能的’和‘模型的直接结果是启发性的’这样的断言是没什么用的。但是UQ可以告诉你你的两个或多个模型假设是相互冲突的，因此你的模型是错的，以及一个完整的UQ分析将会包含一个元分析来验证原始分析对于控制假设的微扰的敏感度。
一个典型的，也许被过度使用的UQ案例是一个带有不确定参数的椭圆偏微分方程（PDE）：
**例1.1** 考虑如下在一个连接的Lipschitz区间 $\chi\subseteq \Re ^n$ (n=2 or 3)的椭圆边界值问题:
$$
-\nabla\cdot(\kappa\nabla u)=f \qquad in\qquad \chi,\qquad(1.1) \\
u=b \qquad on\qquad\partial\chi. 
$$
问题1.1是一个关于一些占据区域$\chi$的流体的压力场的简单但不幼稚的模型。区域$\chi$包含一个材料和描述材料对这个流体通透性的张量场$\kappa:\chi\to\Re^{n\times n}$。有一个力$f:\chi\to\Re$，和一个特指加在边界$\chi$上压力的数$b:\partial\chi\to\Re$边界条件。这个模型在地球科学很有意义，因为Darcy定律断言流体流经这个介质的速度场$v$跟这个压力场的梯度是相关的：
$$
v=\kappa\nabla u
$$
如果这个流体含有一些内容物，那么它也许对于理解流体的速度场$v$何时何地结束很重要。
在一个PDE理论的课程上，你会学到，对于一个给定了肯定和必要边界通透性场$\kappa$，问题1.1在Sobolev空间$H_0^1(\chi)$对每一个处于双Sobolev空间$H^-1(\chi)$内的力场$f$存在一个唯一的弱解$u$。这个就是知名的*正向问题*。这本书的一个目标就是告诉你这还远远不是故事的结尾！随着实践应用的深入，正向问题解的存在于唯一性只是一个开始。这个PDE模型只是真实的一个近似。第二，纵使这个PDE是完美准确的模型，‘真实'的$\kappa$, $f$和$b$也是没法精确知道的。所以我们对于$u=u(\kappa,f,b)$的知识也是不确定的。如果$\kappa,f,b$被当作随机变量，那么$u$也是一个随机变量，那自然的就会对这些随机变量的均值，方差和偏差概率等有兴趣。这就是熟知的*不确定的正向传播*，为了实现这个问题，我们就必须建立一些函数空间内可能性的理论。
另一个问题是我们经常需要求解反向问题：也许我们知道关于$f,b,u$的东西，想通过关系1.1获得$\kappa$的信息。比如我们也许在有些点$x_i\in\chi$观察到压力$u(x_i)$；这个问题被极大的低估，也因此是一个病态问题；病态性是很多反向问题的特点，在观察会被观察噪声打断的事实下只会更加糟糕。另外，在实践中，区域$\chi$和场$f,b,\kappa,u$都会被离散化已经用数值求解，即近似和有限元，所以理解这些离散误差的影响也是非常有益的。
**认知和偶然不确定性**。经常会把不确定性分成两个类型，*认知*和*偶然*不确定性。偶然性（来源于赌博die）涉及到一个固有变量现象。认知性（来源于知识）涉及由于认知缺乏导致的不确定性。如果手上有一个要考虑的模型，认知不确定性经常被进一步分成*模型形式*不确定性，我们对这个模型是否‘结构性正确’有很明显的疑问；和*参数*不确定性，我们可以很信任这个模型形式很好的反映了现实，但是我们不确定特定参数的正确值。
对于一个特定领域，认知和偶然性不确定性的区别是很不精确的，会重复在频率论者和主观主义（即贝叶斯）统计学者之间的争论。一些同时是牛顿物理学者和贝叶斯的拥簇也许会说掷色子结果不是偶然不确定性---一个人没有骰子的初始条件，赌博的材料和形状以及会影响骰子飞行的风等等的足够完全的知识。换句话说，一些不确定性的形式明显不是偶然性的，而是认知性的。比如，当物理学家说他们还没发展一个大统一理论，他们是在说我们缺少我们宇宙的物理定律和这些定律的正确数学表达式。
**一些经典的UQ目标**。很多UQ目标可以在把在一些空间$\chi$的输入$\Chi$映射到一些空间$\nu$的输出$Y=F(\Chi)$的这样一个系统，$F$，内得到解释。包括：

- *前向传播或者推进问题*。假设$F$的输入可以总结成空间$\chi$上的一个概率分布$\mu$。基于此，决定在空间$\nu$上的感应概率分布$F*\mu$，如下定义
$$
(F*\mu)(E):=P_\mu(\{ x\in\chi|F(x)\in E\})\equiv P_\mu [ F(\Chi)\in E].
$$
这个任务在$\mu$成为一个复杂分布，或者$F$时非线性时会被复杂化。因为$(F*\mu)$ 是一个高维对象，更实际的是分辨一些特定结果然后确定如下问题的解：
- *可靠性和证明问题*。假设一些集合$\nu_{fail}\subseteq \nu$标定为‘失败集合’，即输出结果$F(\Chi)\in\nu$是不合需要的。给定关于输入$\Chi$和前向过程$F$ 的合适信息，决定失败了，
$$
P_\mu[F(\Chi)\in \nu]
$$
进一步在失败的时候，离可接受结果偏差有多大，会有什么结果？
- *预测问题*。类似可靠性问题，给定一个最大可接受概率误差$\varepsilon>0$，找到一个集合$\nu_\varepsilon\subseteq \nu$ 使得
$$
P_\mu[F(\Chi)\in \nu_\varepsilon]\ge1-\varepsilon
$$
即预测$F(\Chi)\in\nu_\varepsilon$在最大概率$\varepsilon$的值内是错的。
- *反向问题*，比如态估计（时间变化）或者参数判别（时间不变或者非物理模型参数）。给定一些可能被打断或某种程度不可靠的输出的观察结果$Y$，尝试确定相关的输入$\Chi$，比如$F(X)=Y$。 我们怎么知道对一些$X$的估计比其他更可靠。
- *模型降低，或模型标定问题*。建立另一个函数$F_h$（也许是特定数值参数需要标定的，或者包含特别少输入或输出的变量的一个数值模型）， 比如在一个合理范围的$F_h\approx F$。 量化这个近似的准确度本身可能成为一个证明或预测问题。

有时一个UQ问题包含好几种问题 ，比如你也许必须求解一个反向问题以得到或优化一些模型参数，然后用这些参数传递给其他不确定性研究，因此会有一个可用于支持一些证明问题的决策的预测。
本书旨在提供UQ相关方法的数学原理的介绍，帮助读者整合各种方法求解各自领域的问题。
### 1.3 数学预备知识
本书主要的预备知识基于概率论和希尔伯特空间。==第一部分==：第二第三章是数学基础，分别讲述测量和概率论，Banach和Hilbert空间的线性函数分析和张量积等的解释。第四章简介优化理论，尤其对于线性编程和最小二乘。第五章包括信息和不确定性的总括。==第二部分==：跟UQ相关的数学工具。第六章反向问题的数学处理，尤其贝叶斯解释。对于PDE应用很重要。第七章，针对特定类型反向问题，过滤和数据融合问题。==第八章==介绍正交多项式理论。第九章详细讨论这些积分方法，包括蒙特卡洛。==第十章==包含不确定性传播的一种，叫做敏感性分析和模型化简。第十一章介绍随机变量和其他随机量的谱分解。第十二章覆盖了扰动法。第十三章博阿寒可选扰动范例。最后第十四章讨论了基于概率的UQ。
## 第二章 测量和概率论
概率论，基于Kolmogorov公理和测量论的基础，是一种讨论不确定性的理论。
### 2.1 测量和概率空间
测量和概率论的基本对象是一些抽象集合的空间。我们认为这些样品空间的特定子集是可测量的，每个值都有一个数值概念‘尺度’。在概率论，这个尺度是一个0到1的实数，但其他更普遍的数也是可能的。
**定义 2.1** 一个可测量空间是一对$(\chi,\digamma)$，其中
（a）$\chi$是一个集合，交错样品空间；
（b）$\digamma$ 是一个在$\chi$的$\sigma-algebra$，即一个包含$\oslash$和与$\chi$相关的合集，交集和补集的操作可数应用的集合。$\digamma$的元素叫做可测量集或事件。
**例 2.2** （a）在任意集合$\chi$，都有一个
